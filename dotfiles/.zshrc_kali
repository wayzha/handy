alias osvm_init="OSVM=$(ip route | grep 'via 192.168.119.1' | grep -v '10.11' | cut -d '/' -f 1|sed 's/\.0/\.52/')"

function osvm_up {
  osvm_init
  OSVM="$(echo $OSVM | cut -d '.' -f 1-3)"
  OSVM+=".$1"
}

function osvm_ssh {
  [[ -n $1 ]] && osvm_up $1
  SSH_USER="student"
  SSH_PORT=2222
  echo "ssh connecting to $SSU_USER@$OSVM, port $SSH_PORT"
  ssh $SSH_USER@$OSVM -p $SSH_PORT
}

function osvm_pf {
  [[ -n $1 ]] && osvm_up $1
  RDP_PORT=3389
  echo "Enable local port $RDP_PORT forwards to $OSVM:$RDP_PORT"
  ssh -N -L 0.0.0.0:$RDP_PORT:$OSVM:$RDP_PORT kali
}

# update $OSVM's IP address
osvm_init
